1:查看与CLARK相同职位的员工
  SELECT ENAME
  FROM EMP
  WHERE JOB=(SELECT JOB
	     FROM EMP	
	     WHERE ENAME='CLARK')


2:查看低于公司平均工资的员工
SELECT ENAME
FROM  EMP
WHERE SAL<(SELECT AVG(SAL)
	   FORM EMP)	

3:查看与ALLEN同部门的员工
SELECT ENAME,DEPTNO
FROM EMP
WHERE DEPTON=	(SELECT DEPTNO
		FROM EMP
		WHERE ENAME='ALLEN')
4:查看平均工资低于20号部门平均工资的部门平均工资
SELECT AVG(SAL),DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING AVG(SAL)<
		(SELECT AVG(SAL)
		FROM EMP
		WHERE DEPTNO=20)

5:查看低于自己所在部门平均工资的员工

SELECT ENAME,DEPTNO
FROM EMP E,
	(SELECT AVG(SAL) SA,DEPTNO
	FROM EMP
	GROUP BY DEPTNO) T
WHERE EMP.DEPTNO=T.DEPTNO
      AND E.SAL<T.SA





6:查看公司工资排名的第1-5名
SELECT ROWNUM,SAL,ENAME
FROM EMP
WHERE ROWNUM BETWEEN 1 AND 5




7:查看CLERK职位的人数和其他职位的总人数各多少?

SELECT COUNT(ENAME),DECODE(JOB,
			'CLERK','CLERK'
			,'OTHER')
FROM EMP
GROUP BY DECODE(JOB,
		'CLERK','CLERK'
		,'OTHER')

8:查看每个职位的工资排名
SELECT ENAME ,JOB, 
	ROW_NUMBER() OVER( PARTITION BY JOB
			  ORDER BY SAL DESC)
FROM EMP



9:查看每个职位的工资排名，若工资一致，排名一致
SELECT ENAME,JOB,
	RANK() OVER( PARTITION BY JOB
		     ORDER BY SAL  DESC	)
FROM EMP


10:查看每个职位的工资排名，若工资一致，排名一致，不跳名次。
SELECT ENAME,JOB,
	DENSE_RANK() OVER(PARTITION BY JOB
			  ORDER BY SAL DESC)
FROM EMP

11:分别查看:同部门同职位，同职位，以及所有员工的工资总和
SELECT ENAME,DEPTNO,JOB,SUM(SAL)
FROM EMP
GROUP BY ROLLUP(JOB,DETTNO)



12:分别查看:同部门同职位，同职位，同部门以及所有员工的工资总和
SELECT ENAME,DEPTNO,JOB,SUM(SAL)
FROM EMP
GROUP BY CUBE(JOB,DEPTNO)

13:分别查看同部门同职位和同职位的员工的工资总和
SELECT ENAME,DEPTNO,JOB,SUM(SAL)
FROM EMP
GROUPING SET((JOB,DEPTNO),JOB)